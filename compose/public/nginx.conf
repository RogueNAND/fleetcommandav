server {
  listen 80;
  server_name _;

  include /etc/nginx/mime.types;
  default_type application/octet-stream;

  # We will serve files under /public/ URL path
  # 'alias' prevents double-/public/public and keeps listings/links correct.
  location /public/ {
    alias /usr/share/nginx/html/;
    autoindex on;
    autoindex_exact_size off;
    autoindex_localtime on;

    # Optional: hide dotfiles
    location ~ ^/public/\. {
      deny all;
    }

    # Cache policy (tune to taste)
    add_header Cache-Control "no-store, no-cache, must-revalidate, max-age=0" always;
    add_header Pragma "no-cache" always;

    # Efficient static serving
    sendfile on;
    tcp_nopush on;

    # Try file or directory (autoindex handles directories)
    try_files $uri $uri/ =404;
  }

  # Redirect /public -> /public/ so listings work
  location = /public {
    return 301 /public/;
  }
}
